<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8">
  <title>Entropy Test</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    body {
      background: beige;
      font-family: "Times New Roman", serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    .screen {
      display: none;
      width: 100%;
      height: 100%;
      text-align: center;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    button {
      font-family: "Times New Roman", serif;
      background: black;
      color: white;
      border: none;
      padding: 12px 24px;
      cursor: pointer;
      font-size: 18px;
      margin-top: 20px;
    }
    input[type=text] {
      width: 220px;
      padding: 8px;
      margin-top: 8px;
      font-size: 16px;
    }
    img {
      max-width: 90%;
      max-height: 70vh;
      display: block;
      margin: 0 auto;
    }
    h1 {
      font-size: 60px;
      margin-bottom: 20px;
    }
    .start-text {
      font-size: 20px;
      font-style: italic;
      text-align: left;
      width: 60%;
      margin: 1.5px auto;
      text-indent: 10px;
      line-height: 1.5;
    }
    .questions {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .questions p {
      font-size: 18px;
      margin: 30px 0 15px 0;
      width: 60%;
      text-align: left;
    }
    .questions label {
      font-size: 16px;
      display: inline-block;
      margin: 0 10px;
      text-align: center;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div id="start-screen" class="screen" style="display:flex">
    <h1>ISTRAŽIVANJE PRVIH UTISAKA</h1>
    <button id="next-to-info-btn">dalje</button>
  </div>

  <div id="info-screen" class="screen">
    <p class="start-text">
      Hvala Vam što učestvujete! Nakon što kliknete na dugme za početak, prikazaće vam se serija slika, svaka u trajanju od 10 sekundi, nakon čega će se pojaviti pitanja vezana za prethodnu sliku.
    </p>
    <p class="start-text">
      Vaš zadatak je da odaberete odgovor koji najbolje opisuje vaš osećaj ili mišljenje. Molimo Vas da budete iskreni i da ne žurite, jer ne postoji tačan ili pogrešan odgovor.
    </p>
    <button id="start-btn">kreni</button>
  </div>

  <div id="trial-screen" class="screen">
    <div id="image-wrap">
      <img id="stimulus-img" src="" alt="stimulus">
    </div>
    <div id="questions" class="questions" style="display:none">
      <div>
        <p id="q1-text"></p>
        <div id="q1-options"></div>
      </div>
      <div>
        <p id="q2-text"></p>
        <div id="q2-options"></div>
      </div>
      <div>
        <p id="q3-text"></p>
        <div id="q3-options"></div>
      </div>
      <div>
        <p id="q4-text"></p>
        <input type="text" id="q4">
      </div>
      <button id="next-btn">dalje</button>
    </div>
  </div>

  <div id="end-screen" class="screen">
    <h1>HVALA VAM!</h1>
  </div>

<script>
  const trials = [
    {image:"slika1.jpg", questions:[
    {text:"Ptica je prema letu kao riba prema:", options:["Galeriji","Slikaru","Muzeju","Plivanju"], answer:"Plivanju"},
    {text:"Koji broj dolazi sledeći u nizu: 3, 6, 9, 12, ?", options:["14","15","16","18"], answer:"15"},
    {text:"Koliko različitih dvocifrenih brojeva možemo napraviti koristeći cifre 1, 2, 3 bez ponavljanja?", options:["3","6","9","12"], answer:"6"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika2.jpg", questions:[
    {text:"Koja životinja je poznata kao 'kralj džungle'?", options:["Slon","Lav","Tigar","Medved"], answer:"Lav"},
    {text:"Koji broj dolazi sledeći u nizu: 2, 4, 8, 16, ?", options:["20","24","32","36"], answer:"32"},
    {text:"Ako ★ znači +, a ☾ znači −, koliko je 5 ★ 3 ☾ 2?", options:["6","4","8","10"], answer:"4"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika3.jpg", questions:[
    {text:"Knjiga je prema autoru kao slika prema:", options:["Galeriji","Slikaru","Muzeju","Papiru"], answer:"Slikaru"},
    {text:"Koji broj dolazi sledeći u nizu: 1, 1, 2, 3, 5, 8, ?", options:["10","11","12","13"], answer:"13"},
    {text:"Koja planeta je poznata kao 'crvena planeta'?", options:["Venera","Mars","Jupiter","Saturn"], answer:"Mars"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika4.jpg", questions:[
    {text:"Koliko dvocifrenih brojeva možemo napraviti koristeći cifre 1, 2, 3?", options:["3","6","9","12"], answer:"6"},
    {text:"Ako kocka ima 6 strana i obojimo sve, a zatim je presečemo na 8 jednakih kockica, koliko kockica ima barem dve obojene strane?", options:["4","6","8","0"], answer:"4"},
    {text:"Ako je tvrdnja 'Svi psi laju' tačna, koja je tvrdnja lažna?", options:["Neki psi ne laju","Neki psi laju","Svi psi laju","Nema pasa"], answer:"Neki psi ne laju"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika5.jpg", questions:[
    {text:"Kvadrat je podeljen na 4 jednaka dela. Ako obojimo 3, koji deo je obojen?", options:["1/4","1/2","3/4","4/4"], answer:"3/4"},
    {text:"Ako je A=1, B=2,... koliko je Z+M?", options:["26","39","49","52"], answer:"39"},
    {text:"Koji kontinent ima najviše država?", options:["Azija","Afrika","Evropa","Južna Amerika"], answer:"Afrika"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika6.jpg", questions:[
    {text:"Koji broj dolazi sledeći: 5, 10, 20, 40, ?", options:["50","60","80","100"], answer:"80"},
    {text:"Sunce je prema danu kao mesec prema:", options:["Noći","Svetlu","Zori","Mraku"], answer:"Noći"},
    {text:"Koja država je najveća po površini?", options:["Kanada","Kina","Rusija","SAD"], answer:"Rusija"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika7.jpg", questions:[
    {text:"Koji je hemijski simbol za zlato?", options:["Au","Ag","Gd","Ga"], answer:"Au"},
    {text:"Ako sat i narukvica koštaju 85 €, a sat je 80 € skuplji, koliko košta narukvica?", options:["5","10","15","20"], answer:"5"},
    {text:"Ako majka ima 30 godina, a sin 10, za koliko godina će majka biti 3 puta starija od sina?", options:["5","10","15","20"], answer:"10"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika8.jpg", questions:[
    {text:"Koji broj dolazi sledeći u nizu: 2, 4, 8, 16, ?", options:["20","24","32","36"], answer:"32"},
    {text:"Ptica je prema letu kao riba prema:", options:["Galeriji","Slikaru","Muzeju","Plivanju"], answer:"Plivanju"},
    {text:"Koliko sati treba 3 čoveka da naprave 3 stola ako 9 ljudi napravi 9 stolova za 9 sati?", options:["3","6","9","12"], answer:"9"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]},
  {image:"slika9.jpg", questions:[
    {text:"Na satu je 3:15. Koliki je ugao između kazaljki?", options:["7.5°","52.5°","97.5°","180°"], answer:"97.5°"},
    {text:"Ako jedan radnik napravi 1 cipelu za 1 sat, koliko cipela napravi 6 radnika za 6 sati?", options:["6","12","36","72"], answer:"36"},
    {text:"Koja životinja je poznata kao 'kralj džungle'?", options:["Slon","Lav","Tigar","Medved"], answer:"Lav"},
    {text:"Opišite sadržaj koji ste upravo videli jednom rečju:"}
  ]}
];

let currentIndex = 0;
let rtStart = null;
let results = [];

const startScreen = document.getElementById('start-screen');
const infoScreen = document.getElementById('info-screen');
const trialScreen = document.getElementById('trial-screen');
const endScreen = document.getElementById('end-screen');
const nextToInfoBtn = document.getElementById('next-to-info-btn');
const startBtn = document.getElementById('start-btn');
const stimulusImg = document.getElementById('stimulus-img');
const questionsDiv = document.getElementById('questions');
const nextBtn = document.getElementById('next-btn');
const q1Text = document.getElementById('q1-text');
const q2Text = document.getElementById('q2-text');
const q3Text = document.getElementById('q3-text');
const q4Text = document.getElementById('q4-text');

function createOptions(questionDiv, question, qName){
  questionDiv.innerHTML = "";
  if(!question.options) return;
  question.options.forEach((opt,i)=>{
    const id = qName + "-opt" + i;
    const label = document.createElement("label");
    label.innerHTML = `<input type="radio" name="${qName}" value="${opt}" id="${id}"> ${opt}`;
    questionDiv.appendChild(label);
  });
}

function showImage(){
  const trial = trials[currentIndex];
  stimulusImg.src = "slike/" + trial.image;
  rtStart = performance.now();
  questionsDiv.style.display = 'none';
  stimulusImg.style.display = 'block';

  setTimeout(()=>{
    stimulusImg.style.display = 'none';
    q1Text.textContent = trial.questions[0].text;
    q2Text.textContent = trial.questions[1].text;
    q3Text.textContent = trial.questions[2].text;
    q4Text.textContent = trial.questions[3].text;

    createOptions(document.getElementById('q1-options'), trial.questions[0], "q1-options");
    createOptions(document.getElementById('q2-options'), trial.questions[1], "q2-options");
    createOptions(document.getElementById('q3-options'), trial.questions[2], "q3-options");

    questionsDiv.style.display='block';
    nextBtn.disabled = false;
  },10000);
}

function recordAndContinue(){
  if(rtStart === null) return;
  nextBtn.disabled = true;

  const rt = Math.round(performance.now() - rtStart);
  const trial = trials[currentIndex];
  results.push({
    Vreme: new Date().toISOString(),
    Slika: "slike/" + trial.image,
    Odgovor1: document.querySelector('input[name="q1-options"]:checked')?.value || "",
    Odgovor2: document.querySelector('input[name="q2-options"]:checked')?.value || "",
    Odgovor3: document.querySelector('input[name="q3-options"]:checked')?.value || "",
    Odgovor4: document.getElementById('q4').value,
    RT_ms: rt
  });

  document.getElementById('q4').value = '';
  rtStart = null;
  currentIndex++;

  if(currentIndex < trials.length){
    showImage();
  } else {
    trialScreen.style.display='none';
    endScreen.style.display='flex';
    sendResults();
  }
}

function sendResults(){
  fetch("https://script.google.com/macros/s/AKfycbzMugfkmz2xGQHqyoPebrHvRYGgcCf9CncXLdcR2wBfPTCHcdomK2QdybS9onw2QoZS/exec",{
    method:"POST",
    mode:"no-cors",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(results)
  })
  .then(()=>console.log("✅ Podaci poslati u Google Sheet"))
  .catch(err=>console.error("❌ Greška pri slanju:",err));
}

nextToInfoBtn.addEventListener('click', ()=>{
  startScreen.style.display='none';
  infoScreen.style.display='flex';
});

startBtn.addEventListener('click', ()=>{
  infoScreen.style.display='none';
  trialScreen.style.display='flex';
  showImage();
});

nextBtn.addEventListener('click', recordAndContinue);
</script>
</body>
</html>
